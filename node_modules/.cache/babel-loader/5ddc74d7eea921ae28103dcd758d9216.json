{"ast":null,"code":"var _excluded = [\"a11yTitle\", \"aria-label\", \"alignSelf\", \"children\", \"clear\", \"closeOnChange\", \"defaultValue\", \"disabled\", \"disabledKey\", \"dropAlign\", \"dropHeight\", \"dropProps\", \"dropTarget\", \"emptySearchMessage\", \"focusIndicator\", \"gridArea\", \"id\", \"icon\", \"labelKey\", \"margin\", \"messages\", \"multiple\", \"name\", \"onBlur\", \"onChange\", \"onClick\", \"onClose\", \"onFocus\", \"onKeyDown\", \"onMore\", \"onOpen\", \"onSearch\", \"open\", \"options\", \"placeholder\", \"plain\", \"replace\", \"searchPlaceholder\", \"selected\", \"size\", \"value\", \"valueKey\", \"valueLabel\"];\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { forwardRef, isValidElement, useCallback, useContext, useMemo, useState, useRef, useEffect } from 'react';\nimport styled, { ThemeContext } from 'styled-components';\nimport { controlBorderStyle, normalizeColor } from '../../utils';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { DropButton } from '../DropButton';\nimport { Keyboard } from '../Keyboard';\nimport { FormContext } from '../Form/FormContext';\nimport { TextInput } from '../TextInput';\nimport { SelectContainer } from './SelectContainer';\nimport { applyKey } from './utils';\nimport { MessageContext } from '../../contexts/MessageContext';\nimport { SelectPropTypes } from './propTypes';\nvar SelectTextInput = styled(TextInput).withConfig({\n  displayName: \"Select__SelectTextInput\",\n  componentId: \"sc-17idtfo-0\"\n})([\"cursor:\", \";\"], function (props) {\n  return props.defaultCursor ? 'default' : 'pointer';\n});\nvar HiddenInput = styled.input.withConfig({\n  displayName: \"Select__HiddenInput\",\n  componentId: \"sc-17idtfo-1\"\n})([\"display:none;\"]);\nvar StyledSelectDropButton = styled(DropButton).withConfig({\n  displayName: \"Select__StyledSelectDropButton\",\n  componentId: \"sc-17idtfo-2\"\n})([\"\", \";\", \";\", \";\"], function (props) {\n  return !props.callerPlain && controlBorderStyle;\n}, function (props) {\n  return props.theme.select && props.theme.select.control && props.theme.select.control.extend;\n}, function (props) {\n  return props.open && props.theme.select.control.open;\n});\nStyledSelectDropButton.defaultProps = {};\nObject.setPrototypeOf(StyledSelectDropButton.defaultProps, defaultProps);\nvar defaultDropAlign = {\n  top: 'bottom',\n  left: 'left'\n};\nvar Select = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      ariaLabel = _ref['aria-label'],\n      alignSelf = _ref.alignSelf,\n      children = _ref.children,\n      _ref$clear = _ref.clear,\n      clear = _ref$clear === void 0 ? false : _ref$clear,\n      _ref$closeOnChange = _ref.closeOnChange,\n      closeOnChange = _ref$closeOnChange === void 0 ? true : _ref$closeOnChange,\n      defaultValue = _ref.defaultValue,\n      disabled = _ref.disabled,\n      disabledKey = _ref.disabledKey,\n      _ref$dropAlign = _ref.dropAlign,\n      dropAlign = _ref$dropAlign === void 0 ? defaultDropAlign : _ref$dropAlign,\n      dropHeight = _ref.dropHeight,\n      dropProps = _ref.dropProps,\n      dropTarget = _ref.dropTarget,\n      emptySearchMessage = _ref.emptySearchMessage,\n      focusIndicator = _ref.focusIndicator,\n      gridArea = _ref.gridArea,\n      id = _ref.id,\n      icon = _ref.icon,\n      labelKey = _ref.labelKey,\n      margin = _ref.margin,\n      messages = _ref.messages,\n      multiple = _ref.multiple,\n      name = _ref.name,\n      onBlur = _ref.onBlur,\n      onChange = _ref.onChange,\n      onClick = _ref.onClick,\n      onClose = _ref.onClose,\n      onFocus = _ref.onFocus,\n      onKeyDown = _ref.onKeyDown,\n      onMore = _ref.onMore,\n      onOpen = _ref.onOpen,\n      onSearch = _ref.onSearch,\n      propOpen = _ref.open,\n      optionsProp = _ref.options,\n      placeholder = _ref.placeholder,\n      plain = _ref.plain,\n      replace = _ref.replace,\n      searchPlaceholder = _ref.searchPlaceholder,\n      selected = _ref.selected,\n      size = _ref.size,\n      valueProp = _ref.value,\n      valueKey = _ref.valueKey,\n      valueLabel = _ref.valueLabel,\n      rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme;\n  var inputRef = useRef();\n  var formContext = useContext(FormContext);\n\n  var _useContext = useContext(MessageContext),\n      format = _useContext.format; // value is used for what we receive in valueProp and the basis for\n  // what we send with onChange\n  // When 'valueKey' sets 'reduce', the value(s) here should match\n  // what the 'valueKey' would return for the corresponding\n  // selected option object.\n  // Otherwise, the value(s) should match the selected options.\n\n\n  var _formContext$useFormI = formContext.useFormInput({\n    name: name,\n    value: valueProp,\n    initialValue: defaultValue || ''\n  }),\n      value = _formContext$useFormI[0],\n      setValue = _formContext$useFormI[1]; // valuedValue is the value mapped with any valueKey applied\n  // When the options array contains objects, this property indicates how\n  // to retrieve the value of each option.\n  // If a string is provided, it is used as the key to retrieve a\n  // property of an option object.\n  // If a function is provided, it is called with the option and should\n  // return the value.\n  // If reduce is true, this value will be used for the 'value'\n  // delivered via 'onChange'.\n\n\n  var valuedValue = useMemo(function () {\n    if (Array.isArray(value)) return value.map(function (v) {\n      return valueKey && valueKey.reduce ? v : applyKey(v, valueKey);\n    });\n    return valueKey && valueKey.reduce ? value : applyKey(value, valueKey);\n  }, [value, valueKey]); // search input value\n\n  var _useState = useState(),\n      search = _useState[0],\n      setSearch = _useState[1]; // All select option indices and values\n\n\n  var _useState2 = useState(optionsProp),\n      allOptions = _useState2[0],\n      setAllOptions = _useState2[1]; // Track changes to options property, except when options are being\n  // updated due to search activity. Allows option's initial index value\n  // to be referenced when filtered by search.\n\n\n  useEffect(function () {\n    if (!search) setAllOptions(optionsProp);\n  }, [optionsProp, search]); // the option indexes present in the value\n\n  var optionIndexesInValue = useMemo(function () {\n    var result = [];\n    allOptions.forEach(function (option, index) {\n      if (selected !== undefined) {\n        if (Array.isArray(selected)) {\n          if (selected.indexOf(index) !== -1) result.push(index);\n        } else if (index === selected) {\n          result.push(index);\n        }\n      } else if (Array.isArray(valuedValue)) {\n        if (valuedValue.some(function (v) {\n          return v === applyKey(option, valueKey);\n        })) {\n          result.push(index);\n        }\n      } else if (valuedValue === applyKey(option, valueKey)) {\n        result.push(index);\n      }\n    });\n    return result;\n  }, [allOptions, selected, valueKey, valuedValue]);\n\n  var _useState3 = useState(propOpen),\n      open = _useState3[0],\n      setOpen = _useState3[1];\n\n  useEffect(function () {\n    return setOpen(propOpen);\n  }, [propOpen]);\n  var onRequestOpen = useCallback(function () {\n    if (open) return;\n    setOpen(true);\n    if (onOpen) onOpen();\n  }, [onOpen, open]);\n  var onRequestClose = useCallback(function () {\n    setOpen(false);\n    if (onClose) onClose();\n  }, [onClose]);\n  var triggerChangeEvent = useCallback(function (nextValue) {\n    // Calling set value function directly on input because React library\n    // overrides setter `event.target.value =` and loses original event\n    // target fidelity.\n    // https://stackoverflow.com/a/46012210\n    var nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, 'value').set;\n    nativeInputValueSetter.call(inputRef.current, nextValue);\n    var event = new Event('input', {\n      bubbles: true\n    });\n    inputRef.current.dispatchEvent(event);\n  }, []);\n  var onSelectChange = useCallback(function (event, _ref2) {\n    var option = _ref2.option,\n        nextValue = _ref2.value,\n        nextSelected = _ref2.selected;\n    if (closeOnChange) onRequestClose(); // nextValue must not be of type object to set value directly on the\n    // input. if it is an object, then the user has not provided necessary\n    // props to reduce object option\n\n    if (typeof nextValue !== 'object' && nextValue !== event.target.value && inputRef.current) {\n      // select registers changing option as a click event or keydown.\n      // when in a form, we need to programatically trigger a change\n      // event in order for the change event to be registered upstream\n      // necessary for change validation in form\n      triggerChangeEvent(nextValue);\n    }\n\n    setValue(nextValue);\n\n    if (onChange) {\n      event.persist();\n      var adjustedEvent; // support for native event used by Preact\n\n      if (event instanceof Event) {\n        adjustedEvent = new event.constructor(event.type, event);\n        Object.defineProperties(adjustedEvent, {\n          target: {\n            value: inputRef.current\n          },\n          value: {\n            value: nextValue\n          },\n          option: {\n            value: option\n          },\n          selected: {\n            value: nextSelected\n          }\n        });\n      } else {\n        adjustedEvent = event;\n        adjustedEvent.target = inputRef.current;\n        adjustedEvent.value = nextValue;\n        adjustedEvent.option = option;\n        adjustedEvent.selected = nextSelected;\n      }\n\n      onChange(adjustedEvent);\n    }\n\n    setSearch();\n  }, [closeOnChange, onChange, onRequestClose, setValue, triggerChangeEvent]);\n  var SelectIcon;\n\n  switch (icon) {\n    case false:\n      break;\n\n    case true:\n    case undefined:\n      SelectIcon = open && theme.select.icons.up ? theme.select.icons.up : theme.select.icons.down;\n      break;\n\n    default:\n      SelectIcon = icon;\n  } // element to show, trumps inputValue\n\n\n  var selectValue = useMemo(function () {\n    if (valueLabel) return valueLabel;\n    if ( /*#__PURE__*/React.isValidElement(value)) return value; // deprecated\n\n    return undefined;\n  }, [value, valueLabel]); // text to show\n  // When the options array contains objects, this property indicates how\n  // to retrieve the value of each option.\n  // If a string is provided, it is used as the key to retrieve a\n  // property of an option object.\n  // If a function is provided, it is called with the option and should\n  // return the value.\n  // If reduce is true, this value will be used for the 'value'\n  // delivered via 'onChange'.\n\n  var inputValue = useMemo(function () {\n    if (!selectValue) {\n      if (optionIndexesInValue.length === 0) return '';\n      if (optionIndexesInValue.length === 1) return applyKey(allOptions[optionIndexesInValue[0]], labelKey);\n      return format({\n        id: 'select.multiple',\n        messages: messages\n      });\n    }\n\n    return undefined;\n  }, [labelKey, messages, format, optionIndexesInValue, allOptions, selectValue]);\n  var iconColor = normalizeColor(theme.select.icons.color || 'control', theme);\n  return /*#__PURE__*/React.createElement(Keyboard, {\n    onDown: onRequestOpen,\n    onUp: onRequestOpen\n  }, /*#__PURE__*/React.createElement(StyledSelectDropButton, {\n    ref: ref,\n    a11yTitle: ariaLabel || a11yTitle,\n    id: id,\n    disabled: disabled === true || undefined,\n    dropAlign: dropAlign,\n    dropTarget: dropTarget,\n    open: open,\n    alignSelf: alignSelf,\n    focusIndicator: focusIndicator,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    gridArea: gridArea,\n    margin: margin,\n    onOpen: onRequestOpen,\n    onClose: onRequestClose,\n    onClick: onClick,\n    dropContent: /*#__PURE__*/React.createElement(SelectContainer, {\n      clear: clear,\n      disabled: disabled,\n      disabledKey: disabledKey,\n      dropHeight: dropHeight,\n      emptySearchMessage: emptySearchMessage,\n      id: id,\n      labelKey: labelKey,\n      multiple: multiple,\n      name: name,\n      onChange: onSelectChange,\n      onKeyDown: onKeyDown,\n      onMore: onMore,\n      onSearch: onSearch,\n      options: optionsProp,\n      allOptions: allOptions,\n      optionIndexesInValue: optionIndexesInValue,\n      replace: replace,\n      searchPlaceholder: searchPlaceholder,\n      search: search,\n      setSearch: setSearch,\n      selected: selected,\n      value: value,\n      valueKey: valueKey\n    }, children) // StyledDropButton needs to know if the border should be shown\n    ,\n    callerPlain: plain,\n    plain: true // Button should be plain\n    ,\n    dropProps: dropProps,\n    theme: theme\n  }, /*#__PURE__*/React.createElement(Box, {\n    align: \"center\",\n    direction: \"row\",\n    justify: \"between\",\n    background: theme.select.background\n  }, /*#__PURE__*/React.createElement(Box, {\n    direction: \"row\",\n    flex: true,\n    basis: \"auto\"\n  }, selectValue ? /*#__PURE__*/React.createElement(React.Fragment, null, selectValue, /*#__PURE__*/React.createElement(HiddenInput, {\n    type: \"text\",\n    id: id ? id + \"__input\" : undefined,\n    value: inputValue,\n    ref: inputRef,\n    readOnly: true\n  })) : /*#__PURE__*/React.createElement(SelectTextInput, _extends({\n    a11yTitle: (ariaLabel || a11yTitle) && \"\" + (ariaLabel || a11yTitle) + (value && typeof value === 'string' ? \", \" + value : '') // When Select is disabled, we want to show a default cursor\n    // but not have disabled styling come from TextInput\n    // Disabled can be a bool or an array of options to disable.\n    // We only want to disable the TextInput if the control\n    // button should be disabled which occurs when disabled\n    // equals true.\n    ,\n    defaultCursor: disabled === true || undefined,\n    focusIndicator: false,\n    id: id ? id + \"__input\" : undefined,\n    name: name,\n    ref: inputRef\n  }, rest, {\n    tabIndex: \"-1\",\n    type: \"text\",\n    placeholder: placeholder,\n    plain: true,\n    readOnly: true,\n    value: inputValue,\n    size: size,\n    theme: theme\n  }))), SelectIcon && /*#__PURE__*/React.createElement(Box, {\n    margin: theme.select.icons.margin,\n    flex: false,\n    style: {\n      minWidth: 'auto'\n    }\n  }, /*#__PURE__*/isValidElement(SelectIcon) ? SelectIcon : /*#__PURE__*/React.createElement(SelectIcon, {\n    color: iconColor,\n    size: size\n  })))));\n});\nSelect.defaultProps = _extends({}, defaultProps);\nSelect.displayName = 'Select';\nSelect.propTypes = SelectPropTypes;\nexport { Select };","map":{"version":3,"sources":["/Users/rachel/workout-generator/node_modules/grommet/es6/components/Select/Select.js"],"names":["_excluded","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","forwardRef","isValidElement","useCallback","useContext","useMemo","useState","useRef","useEffect","styled","ThemeContext","controlBorderStyle","normalizeColor","defaultProps","Box","DropButton","Keyboard","FormContext","TextInput","SelectContainer","applyKey","MessageContext","SelectPropTypes","SelectTextInput","withConfig","displayName","componentId","props","defaultCursor","HiddenInput","input","StyledSelectDropButton","callerPlain","theme","select","control","extend","open","setPrototypeOf","defaultDropAlign","top","left","Select","_ref","ref","a11yTitle","ariaLabel","alignSelf","children","_ref$clear","clear","_ref$closeOnChange","closeOnChange","defaultValue","disabled","disabledKey","_ref$dropAlign","dropAlign","dropHeight","dropProps","dropTarget","emptySearchMessage","focusIndicator","gridArea","id","icon","labelKey","margin","messages","multiple","name","onBlur","onChange","onClick","onClose","onFocus","onKeyDown","onMore","onOpen","onSearch","propOpen","optionsProp","options","placeholder","plain","replace","searchPlaceholder","selected","size","valueProp","value","valueKey","valueLabel","rest","inputRef","formContext","_useContext","format","_formContext$useFormI","useFormInput","initialValue","setValue","valuedValue","Array","isArray","map","v","reduce","_useState","search","setSearch","_useState2","allOptions","setAllOptions","optionIndexesInValue","result","forEach","option","index","undefined","push","some","_useState3","setOpen","onRequestOpen","onRequestClose","triggerChangeEvent","nextValue","nativeInputValueSetter","getOwnPropertyDescriptor","window","HTMLInputElement","set","current","event","Event","bubbles","dispatchEvent","onSelectChange","_ref2","nextSelected","persist","adjustedEvent","constructor","type","defineProperties","SelectIcon","icons","up","down","selectValue","inputValue","iconColor","color","createElement","onDown","onUp","dropContent","align","direction","justify","background","flex","basis","Fragment","readOnly","tabIndex","style","minWidth","propTypes"],"mappings":"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","sourcesContent":["var _excluded = [\"a11yTitle\", \"aria-label\", \"alignSelf\", \"children\", \"clear\", \"closeOnChange\", \"defaultValue\", \"disabled\", \"disabledKey\", \"dropAlign\", \"dropHeight\", \"dropProps\", \"dropTarget\", \"emptySearchMessage\", \"focusIndicator\", \"gridArea\", \"id\", \"icon\", \"labelKey\", \"margin\", \"messages\", \"multiple\", \"name\", \"onBlur\", \"onChange\", \"onClick\", \"onClose\", \"onFocus\", \"onKeyDown\", \"onMore\", \"onOpen\", \"onSearch\", \"open\", \"options\", \"placeholder\", \"plain\", \"replace\", \"searchPlaceholder\", \"selected\", \"size\", \"value\", \"valueKey\", \"valueLabel\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef, isValidElement, useCallback, useContext, useMemo, useState, useRef, useEffect } from 'react';\nimport styled, { ThemeContext } from 'styled-components';\nimport { controlBorderStyle, normalizeColor } from '../../utils';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { DropButton } from '../DropButton';\nimport { Keyboard } from '../Keyboard';\nimport { FormContext } from '../Form/FormContext';\nimport { TextInput } from '../TextInput';\nimport { SelectContainer } from './SelectContainer';\nimport { applyKey } from './utils';\nimport { MessageContext } from '../../contexts/MessageContext';\nimport { SelectPropTypes } from './propTypes';\nvar SelectTextInput = styled(TextInput).withConfig({\n  displayName: \"Select__SelectTextInput\",\n  componentId: \"sc-17idtfo-0\"\n})([\"cursor:\", \";\"], function (props) {\n  return props.defaultCursor ? 'default' : 'pointer';\n});\nvar HiddenInput = styled.input.withConfig({\n  displayName: \"Select__HiddenInput\",\n  componentId: \"sc-17idtfo-1\"\n})([\"display:none;\"]);\nvar StyledSelectDropButton = styled(DropButton).withConfig({\n  displayName: \"Select__StyledSelectDropButton\",\n  componentId: \"sc-17idtfo-2\"\n})([\"\", \";\", \";\", \";\"], function (props) {\n  return !props.callerPlain && controlBorderStyle;\n}, function (props) {\n  return props.theme.select && props.theme.select.control && props.theme.select.control.extend;\n}, function (props) {\n  return props.open && props.theme.select.control.open;\n});\nStyledSelectDropButton.defaultProps = {};\nObject.setPrototypeOf(StyledSelectDropButton.defaultProps, defaultProps);\nvar defaultDropAlign = {\n  top: 'bottom',\n  left: 'left'\n};\nvar Select = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      ariaLabel = _ref['aria-label'],\n      alignSelf = _ref.alignSelf,\n      children = _ref.children,\n      _ref$clear = _ref.clear,\n      clear = _ref$clear === void 0 ? false : _ref$clear,\n      _ref$closeOnChange = _ref.closeOnChange,\n      closeOnChange = _ref$closeOnChange === void 0 ? true : _ref$closeOnChange,\n      defaultValue = _ref.defaultValue,\n      disabled = _ref.disabled,\n      disabledKey = _ref.disabledKey,\n      _ref$dropAlign = _ref.dropAlign,\n      dropAlign = _ref$dropAlign === void 0 ? defaultDropAlign : _ref$dropAlign,\n      dropHeight = _ref.dropHeight,\n      dropProps = _ref.dropProps,\n      dropTarget = _ref.dropTarget,\n      emptySearchMessage = _ref.emptySearchMessage,\n      focusIndicator = _ref.focusIndicator,\n      gridArea = _ref.gridArea,\n      id = _ref.id,\n      icon = _ref.icon,\n      labelKey = _ref.labelKey,\n      margin = _ref.margin,\n      messages = _ref.messages,\n      multiple = _ref.multiple,\n      name = _ref.name,\n      onBlur = _ref.onBlur,\n      onChange = _ref.onChange,\n      onClick = _ref.onClick,\n      onClose = _ref.onClose,\n      onFocus = _ref.onFocus,\n      onKeyDown = _ref.onKeyDown,\n      onMore = _ref.onMore,\n      onOpen = _ref.onOpen,\n      onSearch = _ref.onSearch,\n      propOpen = _ref.open,\n      optionsProp = _ref.options,\n      placeholder = _ref.placeholder,\n      plain = _ref.plain,\n      replace = _ref.replace,\n      searchPlaceholder = _ref.searchPlaceholder,\n      selected = _ref.selected,\n      size = _ref.size,\n      valueProp = _ref.value,\n      valueKey = _ref.valueKey,\n      valueLabel = _ref.valueLabel,\n      rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme;\n  var inputRef = useRef();\n  var formContext = useContext(FormContext);\n\n  var _useContext = useContext(MessageContext),\n      format = _useContext.format; // value is used for what we receive in valueProp and the basis for\n  // what we send with onChange\n  // When 'valueKey' sets 'reduce', the value(s) here should match\n  // what the 'valueKey' would return for the corresponding\n  // selected option object.\n  // Otherwise, the value(s) should match the selected options.\n\n\n  var _formContext$useFormI = formContext.useFormInput({\n    name: name,\n    value: valueProp,\n    initialValue: defaultValue || ''\n  }),\n      value = _formContext$useFormI[0],\n      setValue = _formContext$useFormI[1]; // valuedValue is the value mapped with any valueKey applied\n  // When the options array contains objects, this property indicates how\n  // to retrieve the value of each option.\n  // If a string is provided, it is used as the key to retrieve a\n  // property of an option object.\n  // If a function is provided, it is called with the option and should\n  // return the value.\n  // If reduce is true, this value will be used for the 'value'\n  // delivered via 'onChange'.\n\n\n  var valuedValue = useMemo(function () {\n    if (Array.isArray(value)) return value.map(function (v) {\n      return valueKey && valueKey.reduce ? v : applyKey(v, valueKey);\n    });\n    return valueKey && valueKey.reduce ? value : applyKey(value, valueKey);\n  }, [value, valueKey]); // search input value\n\n  var _useState = useState(),\n      search = _useState[0],\n      setSearch = _useState[1]; // All select option indices and values\n\n\n  var _useState2 = useState(optionsProp),\n      allOptions = _useState2[0],\n      setAllOptions = _useState2[1]; // Track changes to options property, except when options are being\n  // updated due to search activity. Allows option's initial index value\n  // to be referenced when filtered by search.\n\n\n  useEffect(function () {\n    if (!search) setAllOptions(optionsProp);\n  }, [optionsProp, search]); // the option indexes present in the value\n\n  var optionIndexesInValue = useMemo(function () {\n    var result = [];\n    allOptions.forEach(function (option, index) {\n      if (selected !== undefined) {\n        if (Array.isArray(selected)) {\n          if (selected.indexOf(index) !== -1) result.push(index);\n        } else if (index === selected) {\n          result.push(index);\n        }\n      } else if (Array.isArray(valuedValue)) {\n        if (valuedValue.some(function (v) {\n          return v === applyKey(option, valueKey);\n        })) {\n          result.push(index);\n        }\n      } else if (valuedValue === applyKey(option, valueKey)) {\n        result.push(index);\n      }\n    });\n    return result;\n  }, [allOptions, selected, valueKey, valuedValue]);\n\n  var _useState3 = useState(propOpen),\n      open = _useState3[0],\n      setOpen = _useState3[1];\n\n  useEffect(function () {\n    return setOpen(propOpen);\n  }, [propOpen]);\n  var onRequestOpen = useCallback(function () {\n    if (open) return;\n    setOpen(true);\n    if (onOpen) onOpen();\n  }, [onOpen, open]);\n  var onRequestClose = useCallback(function () {\n    setOpen(false);\n    if (onClose) onClose();\n  }, [onClose]);\n  var triggerChangeEvent = useCallback(function (nextValue) {\n    // Calling set value function directly on input because React library\n    // overrides setter `event.target.value =` and loses original event\n    // target fidelity.\n    // https://stackoverflow.com/a/46012210\n    var nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, 'value').set;\n    nativeInputValueSetter.call(inputRef.current, nextValue);\n    var event = new Event('input', {\n      bubbles: true\n    });\n    inputRef.current.dispatchEvent(event);\n  }, []);\n  var onSelectChange = useCallback(function (event, _ref2) {\n    var option = _ref2.option,\n        nextValue = _ref2.value,\n        nextSelected = _ref2.selected;\n    if (closeOnChange) onRequestClose(); // nextValue must not be of type object to set value directly on the\n    // input. if it is an object, then the user has not provided necessary\n    // props to reduce object option\n\n    if (typeof nextValue !== 'object' && nextValue !== event.target.value && inputRef.current) {\n      // select registers changing option as a click event or keydown.\n      // when in a form, we need to programatically trigger a change\n      // event in order for the change event to be registered upstream\n      // necessary for change validation in form\n      triggerChangeEvent(nextValue);\n    }\n\n    setValue(nextValue);\n\n    if (onChange) {\n      event.persist();\n      var adjustedEvent; // support for native event used by Preact\n\n      if (event instanceof Event) {\n        adjustedEvent = new event.constructor(event.type, event);\n        Object.defineProperties(adjustedEvent, {\n          target: {\n            value: inputRef.current\n          },\n          value: {\n            value: nextValue\n          },\n          option: {\n            value: option\n          },\n          selected: {\n            value: nextSelected\n          }\n        });\n      } else {\n        adjustedEvent = event;\n        adjustedEvent.target = inputRef.current;\n        adjustedEvent.value = nextValue;\n        adjustedEvent.option = option;\n        adjustedEvent.selected = nextSelected;\n      }\n\n      onChange(adjustedEvent);\n    }\n\n    setSearch();\n  }, [closeOnChange, onChange, onRequestClose, setValue, triggerChangeEvent]);\n  var SelectIcon;\n\n  switch (icon) {\n    case false:\n      break;\n\n    case true:\n    case undefined:\n      SelectIcon = open && theme.select.icons.up ? theme.select.icons.up : theme.select.icons.down;\n      break;\n\n    default:\n      SelectIcon = icon;\n  } // element to show, trumps inputValue\n\n\n  var selectValue = useMemo(function () {\n    if (valueLabel) return valueLabel;\n    if ( /*#__PURE__*/React.isValidElement(value)) return value; // deprecated\n\n    return undefined;\n  }, [value, valueLabel]); // text to show\n  // When the options array contains objects, this property indicates how\n  // to retrieve the value of each option.\n  // If a string is provided, it is used as the key to retrieve a\n  // property of an option object.\n  // If a function is provided, it is called with the option and should\n  // return the value.\n  // If reduce is true, this value will be used for the 'value'\n  // delivered via 'onChange'.\n\n  var inputValue = useMemo(function () {\n    if (!selectValue) {\n      if (optionIndexesInValue.length === 0) return '';\n      if (optionIndexesInValue.length === 1) return applyKey(allOptions[optionIndexesInValue[0]], labelKey);\n      return format({\n        id: 'select.multiple',\n        messages: messages\n      });\n    }\n\n    return undefined;\n  }, [labelKey, messages, format, optionIndexesInValue, allOptions, selectValue]);\n  var iconColor = normalizeColor(theme.select.icons.color || 'control', theme);\n  return /*#__PURE__*/React.createElement(Keyboard, {\n    onDown: onRequestOpen,\n    onUp: onRequestOpen\n  }, /*#__PURE__*/React.createElement(StyledSelectDropButton, {\n    ref: ref,\n    a11yTitle: ariaLabel || a11yTitle,\n    id: id,\n    disabled: disabled === true || undefined,\n    dropAlign: dropAlign,\n    dropTarget: dropTarget,\n    open: open,\n    alignSelf: alignSelf,\n    focusIndicator: focusIndicator,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    gridArea: gridArea,\n    margin: margin,\n    onOpen: onRequestOpen,\n    onClose: onRequestClose,\n    onClick: onClick,\n    dropContent: /*#__PURE__*/React.createElement(SelectContainer, {\n      clear: clear,\n      disabled: disabled,\n      disabledKey: disabledKey,\n      dropHeight: dropHeight,\n      emptySearchMessage: emptySearchMessage,\n      id: id,\n      labelKey: labelKey,\n      multiple: multiple,\n      name: name,\n      onChange: onSelectChange,\n      onKeyDown: onKeyDown,\n      onMore: onMore,\n      onSearch: onSearch,\n      options: optionsProp,\n      allOptions: allOptions,\n      optionIndexesInValue: optionIndexesInValue,\n      replace: replace,\n      searchPlaceholder: searchPlaceholder,\n      search: search,\n      setSearch: setSearch,\n      selected: selected,\n      value: value,\n      valueKey: valueKey\n    }, children) // StyledDropButton needs to know if the border should be shown\n    ,\n    callerPlain: plain,\n    plain: true // Button should be plain\n    ,\n    dropProps: dropProps,\n    theme: theme\n  }, /*#__PURE__*/React.createElement(Box, {\n    align: \"center\",\n    direction: \"row\",\n    justify: \"between\",\n    background: theme.select.background\n  }, /*#__PURE__*/React.createElement(Box, {\n    direction: \"row\",\n    flex: true,\n    basis: \"auto\"\n  }, selectValue ? /*#__PURE__*/React.createElement(React.Fragment, null, selectValue, /*#__PURE__*/React.createElement(HiddenInput, {\n    type: \"text\",\n    id: id ? id + \"__input\" : undefined,\n    value: inputValue,\n    ref: inputRef,\n    readOnly: true\n  })) : /*#__PURE__*/React.createElement(SelectTextInput, _extends({\n    a11yTitle: (ariaLabel || a11yTitle) && \"\" + (ariaLabel || a11yTitle) + (value && typeof value === 'string' ? \", \" + value : '') // When Select is disabled, we want to show a default cursor\n    // but not have disabled styling come from TextInput\n    // Disabled can be a bool or an array of options to disable.\n    // We only want to disable the TextInput if the control\n    // button should be disabled which occurs when disabled\n    // equals true.\n    ,\n    defaultCursor: disabled === true || undefined,\n    focusIndicator: false,\n    id: id ? id + \"__input\" : undefined,\n    name: name,\n    ref: inputRef\n  }, rest, {\n    tabIndex: \"-1\",\n    type: \"text\",\n    placeholder: placeholder,\n    plain: true,\n    readOnly: true,\n    value: inputValue,\n    size: size,\n    theme: theme\n  }))), SelectIcon && /*#__PURE__*/React.createElement(Box, {\n    margin: theme.select.icons.margin,\n    flex: false,\n    style: {\n      minWidth: 'auto'\n    }\n  }, /*#__PURE__*/isValidElement(SelectIcon) ? SelectIcon : /*#__PURE__*/React.createElement(SelectIcon, {\n    color: iconColor,\n    size: size\n  })))));\n});\nSelect.defaultProps = _extends({}, defaultProps);\nSelect.displayName = 'Select';\nSelect.propTypes = SelectPropTypes;\nexport { Select };"]},"metadata":{},"sourceType":"module"}